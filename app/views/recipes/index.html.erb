<div class="container">
  <% if params[:query].present? && !@no_results %>
    <div class="search-results-number">
      <span><%= @recipes.count %> Recipes for "<%= params[:query] %>"</span>
    </div>
  <% end %>
  <div class="latest-recipes">
    <% if @no_results %>
      <p>No Recipes Found</p>
    <% elsif params[:query].present? %>
      <div class="search-results">
        <% @recipes.each do |recipe| %>
          <div class="recipe-card small recipe-card search" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url('<%= recipe.photo_url %>');">
            <div class="icons">
              <%= link_to favourites_create_path(recipe: recipe.id), data: {turbo_method: :post} do %>
                <i class="fas fa-heart"></i>
              <% end %>
              <%= link_to ratings_create_path(recipe: recipe.id), data: {turbo_method: :post} do %>
                <i class="fa-solid fa-star"></i>
              <% end %>
            </div>
            <%= link_to recipe_path(recipe[:id]) do %>
              <div class="text">
                <h2><%= recipe.title %> <span class="star-button gold-star"></span></h2>
              </div>
              <div class="rating-info">
                <% if recipe.ratings.average(:value) == nil %>
                  <span> (N/A) </span>
                <% else %>
                  <span> (<%= recipe.ratings.average(:value)%>) </span>
                <% end %>
              </div>
            <% end %>
          </div>
        <% end %>
      </div>
    <% else %>
      <div class="recipe-card large" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url('<%= @recipes[0].photo_url %>');">
        <div class="icons">
          <%= link_to favourites_create_path(recipe: @recipes[0].id), data: {turbo_method: :post} do %>
            <i class="fas fa-heart"></i>
          <% end %>
          <%= link_to ratings_create_path(recipe: @recipes[0].id), data: {turbo_method: :post} do %>
            <i class="fa-solid fa-star"></i>
          <% end %>
        </div>
        <%= link_to recipe_path(@recipes[0][:id]) do %>
          <div class="text">
            <h2><%= @recipes[0].title %></h2>
          </div>
        <% end %>
      </div>
      <div class="two-card-recipe">
        <% @recipes[1..2].each do |recipe| %>
          <div class="recipe-card small" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url('<%= recipe.photo_url %>');">
            <div class="icons">
              <%= link_to favourites_create_path(recipe: recipe.id), data: {turbo_method: :post} do %>
                <i class="fas fa-heart"></i>
              <% end %>
              <%= link_to ratings_create_path(recipe: recipe.id), data: {turbo_method: :post} do %>
                <i class="fa-solid fa-star"></i>
              <% end %>
            </div>
            <%= link_to recipe_path(recipe[:id]) do %>
              <div class="text">
                <h2><%= recipe.title %></h2>
              </div>
            <% end %>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>

  <% unless params[:query].present? %>
  <h2 class="trending-header">Trending Categories</h2>
    <div class="trending-category-buttons">
      <% @explore_more_buttons.each do |category| %>
        <button><%= category.title %></button>
      <% end %>
    </div>
    <div class="trending-categories">
      <div class="four-categories">
        <% @trending_categories.each do |category| %>
          <%= link_to category_show_path(title: category.title.downcase) do %>
            <h2><%= category.title %></h2>
            <img src="<%= category.photo_url %>" alt="<%= category.title %>">
          <% end %>
        <% end %>
      </div>
    </div>
    <div class="explore-more">
      <h2>Explore More</h2>
      <% @explore_more.each do |category| %>
        <%= link_to category_show_path(title: category.title.downcase) do %>
          <h2><%= category.title %></h2>
          <img src="<%= category.photo_url %>" alt="<%= category.title %>">
        <% end %>
      <% end %>
    </div>
  <% end %>
</div>
